digraph Login {
    Login -> Client_MM
    subgraph metamask {
        node [style=filled,color=white];
        style=filled;
        color=red;
        Client_MM[style=box];
        Client_MM -> Install_MetaMask_Prompt -> Connect_To_MetaMask_Prompt -> MetaMask;
        MetaMask -> Sign_Message -> User_Password -> MetaMask;
        MetaMask -> Return_Hash -> Truncate_to_64;
        Truncate_to_64 -> Generate_Whisper_Keypair;
        label = "MetaMask Login";
    }

    Login -> Client_SM
    subgraph socialMedia {
        node [style=filled];
        Client_SM -> LogIn_with_SM -> OAuth_Firebase_uPort;
        OAuth_Firebase_uPort -> JWT_OAuth -> Key_Server;
        Key_Server -> Encrypted_User_PK -> Client_SM;
        Client_SM -> Decrypt_PK_With_Pass -> User_ETH_Private_Key;
        User_ETH_Private_Key -> Sign_Message_PK -> Return_Hash;
        label = "Social Media/ uPort";
        color=blue
    }

    subgraph anon {
        node [style=filled];
        Client_Anon -> Web3js -> Generate_ETH_Account;
        Generate_ETH_Account -> User_ETH_Private_Key;
        Generate_ETH_Account -> User_Export_ETH_PK
        label = "Anonymous";
        color=coral;

    }
    Generate_Whisper_Keypair -> Logged_In;

    // Outside Services
    MetaMask [shape=box];
    OAuth_Firebase_uPort [shape=box];

    Login [shape=Mdiamond];
    Logged_In [shape=Msquare];
}
